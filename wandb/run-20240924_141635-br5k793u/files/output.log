D:\SEGMENTACJA\pythonProject\H_SEG\inference.py:425: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model.load_state_dict(torch.load(model_path))
GPU dostÄ™pne: NVIDIA GeForce RTX 2060
D:\SEGMENTACJA\SegSperm_part\SegSperm_part/test/GT1_mixed
(119,)
X shape: (119, 512, 512, 3)
y shape: (119, 512, 512, 4)
Mean IoU oneclass (annotator1): 0.6169065741806696
IoU per class oneclass (annotator1): [0.99565847 0.61690657]
Mean IoU multiclass (annotator1): 0.645957960305785
IoU per class multiclass (annotator1): [0.99506255 0.51784214 0.77407378]
Mean IoU oneclass 0.5 (annotator1): 0.6169065741806696
IoU per class oneclass 0.5 (annotator1): [0.99565847 0.61690657]
Mean IoU multiclass 0.5 (annotator1): 0.18100426393815244
IoU per class multiclass 0.5 (annotator1): [0.99506255 0.36200853 0.        ]
Iou 1 calculated
Iou 2 calculated
Iou 3 calculated
Iou 4 calculated
Iou 5 calculated
Iou 6 calculated
Iou 7 calculated
Iou 8 calculated
Iou 9 calculated
Iou 10 calculated
Iou 11 calculated
Iou 12 calculated
Iou 13 calculated
Iou 14 calculated
Iou 15 calculated
Iou 16 calculated
Iou 17 calculated
Iou 18 calculated
Iou 19 calculated
Iou 20 calculated
Iou 21 calculated
Iou 22 calculated
Iou 23 calculated
Iou 24 calculated
Iou 25 calculated
Iou 26 calculated
Iou 27 calculated
Iou 28 calculated
Iou 29 calculated
Iou 30 calculated
Iou 31 calculated
Iou 32 calculated
Iou 33 calculated
Iou 34 calculated
Iou 35 calculated
Iou 36 calculated
Iou 37 calculated
Iou 38 calculated
Iou 39 calculated
Iou 40 calculated
Iou 41 calculated
Iou 42 calculated
Iou 43 calculated
Iou 44 calculated
Iou 45 calculated
Iou 46 calculated
Iou 47 calculated
Iou 48 calculated
Iou 49 calculated
Iou 50 calculated
Iou 51 calculated
Iou 52 calculated
Iou 53 calculated
Iou 54 calculated
Iou 55 calculated
Iou 56 calculated
Iou 57 calculated
Iou 58 calculated
Iou 59 calculated
Iou 60 calculated
Iou 61 calculated
Iou 62 calculated
Iou 63 calculated
Iou 64 calculated
Iou 65 calculated
Iou 66 calculated
Iou 67 calculated
Iou 68 calculated
Iou 69 calculated
Iou 70 calculated
Iou 71 calculated
Iou 72 calculated
Iou 73 calculated
Iou 74 calculated
Iou 75 calculated
Iou 76 calculated
Iou 77 calculated
Iou 78 calculated
Iou 79 calculated
Iou 80 calculated
Iou 81 calculated
Iou 82 calculated
Iou 83 calculated
Iou 84 calculated
Iou 85 calculated
Iou 86 calculated
Iou 87 calculated
Iou 88 calculated
Iou 89 calculated
Iou 90 calculated
Iou 91 calculated
Iou 92 calculated
Iou 93 calculated
Iou 94 calculated
Iou 95 calculated
Iou 96 calculated
Iou 97 calculated
Iou 98 calculated
Iou 99 calculated
Iou 100 calculated
Iou 101 calculated
Iou 102 calculated
Iou 103 calculated
Iou 104 calculated
Iou 105 calculated
Iou 106 calculated
Iou 107 calculated
Iou 108 calculated
Iou 109 calculated
Iou 110 calculated
Iou 111 calculated
Iou 112 calculated
Iou 113 calculated
Iou 114 calculated
Iou 115 calculated
Iou 116 calculated
Iou 117 calculated
Iou 118 calculated
Iou 119 calculated
Iou 120 calculated
Iou 121 calculated
Iou 122 calculated
Iou 123 calculated
Iou 124 calculated
Iou 125 calculated
Iou 126 calculated
Iou 127 calculated
Iou 128 calculated
Iou 129 calculated
Iou 130 calculated
Iou 131 calculated
Iou 132 calculated
Iou 133 calculated
Iou 134 calculated
Iou 135 calculated
Iou 136 calculated
Iou 137 calculated
Iou 138 calculated
Iou 139 calculated
Iou 140 calculated
Iou 141 calculated
Iou 142 calculated
Iou 143 calculated
Iou 144 calculated
Iou 145 calculated
Iou 146 calculated
Iou 147 calculated
Iou 148 calculated
Iou 149 calculated
Iou 150 calculated
Iou 151 calculated
Iou 152 calculated
Iou 153 calculated
Iou 154 calculated
Iou 155 calculated
Iou 156 calculated
Iou 157 calculated
Iou 158 calculated
Iou 159 calculated
Iou 160 calculated
Iou 161 calculated
Iou 162 calculated
Iou 163 calculated
Iou 164 calculated
Iou 165 calculated
Iou 166 calculated
Iou 167 calculated
Iou 168 calculated
Iou 169 calculated
Iou 170 calculated
Iou 171 calculated
Iou 172 calculated
Iou 173 calculated
Iou 174 calculated
Iou 175 calculated
Iou 176 calculated
Iou 177 calculated
Iou 178 calculated
Iou 179 calculated
Iou 180 calculated
Iou 181 calculated
Iou 182 calculated
Iou 183 calculated
Iou 184 calculated
Iou 185 calculated
Iou 186 calculated
Iou 187 calculated
Iou 188 calculated
Iou 189 calculated
Iou 190 calculated
Iou 191 calculated
Iou 192 calculated
Iou 193 calculated
Iou 194 calculated
Iou 195 calculated
Iou 196 calculated
Iou 197 calculated
Iou 198 calculated
Iou 199 calculated
Iou 200 calculated
Iou 201 calculated
Iou 202 calculated
Iou 203 calculated
Iou 204 calculated
Iou 205 calculated
Iou 206 calculated
Iou 207 calculated
Iou 208 calculated
Iou 209 calculated
Iou 210 calculated
Iou 211 calculated
Iou 212 calculated
Iou 213 calculated
Iou 214 calculated
Iou 215 calculated
Iou 216 calculated
Iou 217 calculated
Iou 218 calculated
Iou 219 calculated
Iou 220 calculated
Iou 221 calculated
Iou 222 calculated
Iou 223 calculated
Iou 224 calculated
Iou 225 calculated
Iou 226 calculated
Iou 227 calculated
Iou 228 calculated
Iou 229 calculated
Iou 230 calculated
Iou 231 calculated
Iou 232 calculated
Iou 233 calculated
Iou 234 calculated
Iou 235 calculated
Iou 236 calculated
Iou 237 calculated
Iou 238 calculated
Iou 239 calculated
Iou 240 calculated
Iou 241 calculated
Iou 242 calculated
Iou 243 calculated
Iou 244 calculated
Iou 245 calculated
Iou 246 calculated
Iou 247 calculated
Iou 248 calculated
Iou 249 calculated
Iou 250 calculated
Iou 251 calculated
Iou 252 calculated
Iou 253 calculated
Iou 254 calculated
Iou 255 calculated
Optimal threshold for multiclass: 0.5629920959472656, IoU: 0.6495247171820596
Optimal threshold for oneclass: 0.31889763474464417, IoU: 0.6438837851062917
Optimal threshold for head: 0.4488188922405243, IoU: 0.7742274514190796
Optimal threshold for tail: 0.6377952694892883, IoU: 0.5316913405135588
Optimal threshold for merge: 0.6377952694892883, IoU: 0.6399041132284535
Full agreement mask:
FULL AGREEMENT IOU: 0.6530599733823734